<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Himanshu AI | Enterprise v7</title>
    <script src="https://js.puter.com/v2/"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&family=Outfit:wght@300;600;800&family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet">
    <style>
        :root { --bg: #030305; --accent: #00f2ff; --dev: #7ee787; --glass: rgba(255, 255, 255, 0.03); --border: rgba(255, 255, 255, 0.07); }
        body, html { margin: 0; padding: 0; background: var(--bg); color: #e4e4e7; font-family: 'Outfit', sans-serif; height: 100vh; overflow: hidden; }

        /* Login Screen */
        #auth-gate { position: fixed; inset: 0; z-index: 999; display: flex; align-items: center; justify-content: center; background: radial-gradient(circle at center, #111, #000); }
        .login-card { background: rgba(255,255,255,0.02); border: 1px solid var(--border); padding: 40px; border-radius: 24px; backdrop-filter: blur(20px); width: 350px; text-align: center; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); }
        .login-card input { width: 100%; background: var(--glass); border: 1px solid var(--border); padding: 12px; margin: 10px 0; border-radius: 10px; color: white; outline: none; box-sizing: border-box; }
        .login-card button { width: 100%; background: var(--accent); color: #000; padding: 12px; border: none; border-radius: 10px; font-weight: 800; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        .login-card button:hover { transform: scale(1.02); box-shadow: 0 0 20px rgba(0, 242, 255, 0.4); }

        /* Main App (Hidden initially) */
        #main-app { display: none; height: 100vh; flex-direction: row; }
        .sidebar { width: 260px; background: #0a0a0c; border-right: 1px solid var(--border); padding: 30px 15px; display: flex; flex-direction: column; gap: 8px; }
        .workspace { flex: 1; display: flex; flex-direction: column; position: relative; }
        
        /* Chat & Tools */
        #chat-flow { flex: 1; overflow-y: auto; padding: 40px 15%; }
        .input-deck { padding: 20px 15% 40px; }
        .bar-container { background: #111114; border: 1px solid var(--border); border-radius: 20px; padding: 8px 15px; display: flex; align-items: center; gap: 12px; }
        textarea { flex: 1; background: none; border: none; color: #fff; outline: none; font-size: 1rem; resize: none; }
        .tool-btn { color: #71717a; cursor: pointer; font-size: 1.3rem; transition: 0.2s; }
        .tool-btn:hover { color: var(--accent); }

        /* Coder Mode UI */
        .msg.dev { border-left: 3px solid var(--dev); padding-left: 15px; background: rgba(126, 231, 135, 0.02); }
        .ai-avatar { background: var(--accent); color: #000; }
        .user-avatar { background: #27272a; }
        .nav-btn { padding: 12px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 10px; transition: 0.2s; color: #a1a1aa; }
        .nav-btn.active { background: rgba(0, 242, 255, 0.1); color: var(--accent); }
    </style>
</head>
<body>

    <div id="auth-gate">
        <div class="login-card">
            <h2 style="color:var(--accent); margin-bottom: 5px;">HIMANSHU AI</h2>
            <p style="font-size: 0.8rem; color: #71717a; margin-bottom: 30px;">Access Secure Neural Link</p>
            <input type="text" id="user-email" placeholder="Email Address">
            <input type="password" id="user-pass" placeholder="Secure Password">
            <button onclick="login()">INITIALIZE SYSTEM</button>
            <p style="font-size: 0.7rem; color: #52525b; margin-top: 20px;">v7.0 Stable Enterprise Edition</p>
        </div>
    </div>

    <div id="main-app">
        <aside class="sidebar">
            <div style="font-weight:800; color:var(--accent); margin-bottom:30px; font-size:1.2rem;">H-AI ARCHITECT</div>
            <div id="btn-chat" class="nav-btn active" onclick="setMode('chat')"><span class="material-symbols-rounded">chat_bubble</span> Chat & Logic</div>
            <div id="btn-dev" class="nav-btn" onclick="setMode('dev')"><span class="material-symbols-rounded">terminal</span> Coder Hub</div>
            <div id="btn-res" class="nav-btn" onclick="setMode('research')"><span class="material-symbols-rounded">manage_search</span> Deep Research</div>
            <div class="nav-btn" onclick="location.reload()" style="margin-top:auto;"><span class="material-symbols-rounded">logout</span> Terminal Exit</div>
        </aside>

        <main class="workspace">
            <div id="chat-flow"></div>
            <div class="input-deck">
                <div class="bar-container">
                    <span class="material-symbols-rounded tool-btn" onclick="alert('File Explorer coming soon')">attach_file</span>
                    <textarea id="prompt" placeholder="Analyze code, research, or chat..." rows="1"></textarea>
                    <span class="material-symbols-rounded tool-btn" onclick="startVoice()">mic</span>
                    <span class="material-symbols-rounded tool-btn" style="color:var(--accent); font-weight:800;" onclick="execute()">send</span>
                </div>
            </div>
        </main>
    </div>

    <script type="module">
        const API_KEY = "AIzaSyAIoMr29qRilRdjpSbZOfbNBT_FMFK1c30";
        let mode = 'chat';

        window.login = () => {
            const email = document.getElementById('user-email').value;
            if(email.includes('@')) {
                document.getElementById('auth-gate').style.display = 'none';
                document.getElementById('main-app').style.display = 'flex';
                addMsg(`Welcome back, **${email.split('@')[0]}**. System is ready for advanced tasks.`, 'ai');
            } else { alert("Please enter a valid credential."); }
        };

        window.setMode = (m) => {
            mode = m;
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${m.substring(0,3)}`).classList.add('active');
        };

        window.execute = async () => {
            const el = document.getElementById('prompt');
            const val = el.value.trim();
            if(!val) return;

            addMsg(val, 'user');
            el.value = '';

            const status = addMsg("Calculating...", 'ai', true);

            try {
                let context = mode === 'dev' ? "SYSTEM: Acting as Senior Architect. Review and write optimized code." : "SYSTEM: Assist user.";
                if(val.startsWith('/draw')) { return await genImg(val, status); }

                const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ contents: [{ parts: [{ text: `${context}\n\nUser: ${val}` }] }] })
                });

                const data = await res.json();
                status.querySelector('.content').innerHTML = parse(data.candidates[0].content.parts[0].text);
            } catch (e) { status.querySelector('.content').innerHTML = "ERROR: Failed to connect to Neural Cloud."; }
        };

        async function genImg(p, msgObj) {
            msgObj.querySelector('.content').innerText = "Synthesizing 4K Visuals...";
            try {
                const img = await puter.ai.txt2img(p.replace('/draw',''), { provider: "together-ai" });
                msgObj.querySelector('.content').innerHTML = "";
                img.style.width = "100%"; img.style.borderRadius = "12px";
                msgObj.querySelector('.content').appendChild(img);
            } catch { msgObj.querySelector('.content').innerText = "Image synthesis node busy. Retry in 60s."; }
        }

        function addMsg(t, role, pending = false) {
            const div = document.createElement('div');
            div.className = `msg ${mode === 'dev' ? 'dev' : ''}`;
            const icon = role==='user'?'person':'auto_awesome';
            div.innerHTML = `<div class="avatar ${role}-avatar"><span class="material-symbols-rounded">${icon}</span></div><div class="content">${pending?t:parse(t)}</div>`;
            document.getElementById('chat-flow').appendChild(div);
            document.getElementById('chat-flow').scrollTop = document.getElementById('chat-flow').scrollHeight;
            return div;
        }

        function parse(t) {
            return t.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/```(\w+)?\n([\s\S]*?)```/g, '<pre style="background:#000; padding:15px; border-radius:10px; border:1px solid var(--border);"><code>$2</code></pre>')
                    .replace(/\n/g, '<br>');
        }
    </script>
</body>
</html>
